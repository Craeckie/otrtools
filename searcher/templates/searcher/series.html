{% extends 'searcher/base.html' %}

{% load crispy_forms_tags %}

{% block header %}
  {% include 'searcher/modules/header.html' with title="Series" %}
{% endblock %}

{% block navbar %}
  {% include 'searcher/modules/navbar.html' with page="series" %}
{% endblock %}
{% block content %}
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <h1>Series</h1>
      </div>
      <div class="col-lg-6">
        <h3>Select a series</h3>
        <table class="table">
          <tbody>
          {% for s in serieslist %}
          <tr>
            <td><a href="{% url 'searcher:series' series=s season=1 %}">{{s.series}}</td>
            <td><select name="">
              <option value="0">Select Episode</option>
              <option value="-1" onclick="location.href='http://127.0.0.1:8000/search/series/1/1';">All</option>
              <option value="1">1</option>
              <option value="2">2</option>
            </select></td>
          </tr>
          {% empty %}
          <tr>
            <td>No series available.</td>
          </tr>
          {% endfor %}
          </tbody>
        </table>
        </div>
      <div class="col-lg-6">
        <h3>Add a new series</h3>
        {% crispy form %}
      </div>
      <div class="col-lg-12">
        <table class="table table-striped">
          {% for e in episodes %}
            <tr>
              <td>{% if e.decoded %}<span style="text-decoration-line: line-through;">{% endif %}<a target="_blank" href="{{ e.url }}">{{ e.season }}x{{ e.episode }} {{ e.title }}</a>{% if e.decoded %}</span>{% endif %}</td>
              {% with e.otr as titles %}
              <td>
                <table class="table table-striped">
                {% if titles %}
                    {% include "searcher/modules/items.html" with items=titles num=forloop.counter destName=e.destName %}
                {% else %}
                  <tr><td>No files found for this episode. <a target="_blank" href="https://otrkeyfinder.com/en/?search={{ e.search }}&order=date-name">Search manually</a>.</td></tr>
                {% endif %}
                </table>
              </td>
              {% endwith %}
            </tr>
          {% endfor %}
        </table>
      </div>
    </div>
  </div>
{% endblock %}
